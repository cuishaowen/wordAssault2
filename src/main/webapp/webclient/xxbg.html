<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="keywords" content="">
    <meta name="description" content="" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=no,minimum-scale=1.0,maximum-scale=1.0" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="format-detection" content="email=no" />
    <meta http-equiv="X-UA-Compatible" content="chrome=1,IE=edge" />
    <title>学习报告</title>
    <link rel="stylesheet" href="layui/css/layui.css">
    <link rel="stylesheet" href="css/style.css">
</head>
<style>
    .layui-bg-green{background-color:#1d8183!important;}
    .layui-nav-item{cursor: pointer;width:10%;text-align: center;}
    .layui-nav{min-width: 1360px;}
    .layui-nav * { font-size: 16px;}
    .layui-form-label{width:120px;!important;}
    .layui-input-block {margin-left: 150px;}
</style>
<body class="bgbody">
<ul class="layui-nav layui-bg-blue">
    <div class="logobg">
        <img class="logo" src="images/logo.png">
    </div>
    <li class="layui-nav-item "><a href="index.html">音标</a></li>
    <li class="layui-nav-item "><a href="dcxl.html">单词突击</a></li>
    <li class="layui-nav-item"><a href="llkNew.html">连连看</a></li>
    <!--<li class="layui-nav-item "><a href="dchg.html">单词回顾</a></li>-->
    <li class="layui-nav-item "><a href="chl.html">刷题测试</a></li>
    <li class="layui-nav-item"><a href="yftj.html" >语法突击</a></li>
    <li class="layui-nav-item layui-this"><a href="#">学习报告</a></li>
    <li class="layui-nav-item tc" lay-unselect="">
        <a href="javascript:;">
            <img src="images/20150607110911_kY5cP.jpeg" class="layui-nav-img">
            <strong id="loginUserName"></strong></a>
        <dl class="layui-nav-child">
            <dd><a href="jbsz.html">个人设置</a></dd>
            <dd><a href="#" onclick="loginOut()">退出登陆</a></dd>
        </dl>
    </li>
</ul>
<div class="bg">
    <div class="bg-content">
        <div class="bg-left">
            <div class="tx">
                <audio id="music" src="" loop="loop" autoplay="autoplay"></audio>
                <img id="music-B" class="music-img" src="./images/muslogo.png" alt="" style="margin-top: 10px;">
                <img id="music-R"  class="music-img" src="./images/musicred.png" alt="" style="margin-top: 10px;display: none">
                <img class="tx-img" src="images/20150607110911_kY5cP.jpeg" alt="">
                <div class="nickname">
                    <strong id="userName"></strong>同学
                    <p>您是第<strong class="red" id="num"></strong>位学员</p>
                    <p>欢迎您第<strong class="red" id="loginTimes"></strong>次登陆系统</p>
                </div>
                <div class="kc">
                    <span onclick="kczx()">
                        <i class="img"></i>
                        <i>课程中心</i>
                    </span>
                </div>

            </div>

            <div class="gm">
                <div class="title">
                    <div class="title">已经购买课程 <i></i></div>
                </div>
                <div class="gm-kc">
                    <ul id="alreadyPurchase"></ul>
                </div>
            </div>
        </div>
        <div class="bg-right">
            <div class="bg-title">
                <span style="background:url('images/bg.png')no-repeat center;background-size:100% 100%;width:20px;"></span> 学习报告
            </div>
            <div class="bg1">
                <div class="layui-tab">
                    <ul class="layui-tab-title">
                        <li class="layui-this">
                            <img class="tab_img" src="images/10.png">
                            单词数量</li>
                        <li >
                            <img class="tab_img" src="images/11-1.png">
                            学习时间</li>
                        <li >
                            <img class="tab_img" src="images/12-1.png">
                            课程详情</li>
                    </ul>
                    <div class="layui-tab-content">
                        <div class="layui-tab-item layui-show">
                            <div id="container" style=" width: 708px;height: 300px;margin:0 auto;"></div>
                        </div>
                        <div class="layui-tab-item">
                            <div id="container1" style=" width: 708px;height: 300px;margin:0 auto;"></div>
                        </div>
                        <div class="layui-tab-item">
                            <div class="table1" style="height: auto;">
                                <table class="layui-table">
                                    <colgroup>
                                        <col width="50">
                                        <col width="250">
                                        <col width="30">
                                    </colgroup>
                                    <thead>
                                    <tr style="background-color: #43A3E8; color: #fff;">
                                        <th>课程</th>
                                        <th>课程情况</th>
                                        <th>刷题测试成绩</th>
                                    </tr>
                                    </thead>
                                    <tbody id="tbody">
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>
</body>
<script src="layui/layui.js"></script>
<script src="js/jquery-2.1.4.js"></script>
<script src="js/echarts.common.min.js"></script>
<script src="../static/common/website.js"></script>
<script src="js/common.js"></script>
<script>

    layui.use('element', function(){
        var element = layui.element; //导航的hover效果、二级菜单等功能，需要依赖element模块

        //监听导航点击
        element.on('nav(demo)', function(elem){
            //console.log(elem)
            layer.msg(elem.text());
        });
    });
    function sp(){
        $('.bg').height($(window).height() - 120);
        $('.gm').height($('.bg-left').height() - 300);
        $('.gm-kc').height($('.gm').height() - 71);
        $('.layui-tab-content').height($('.bg-right').height() - 132)
    };
    sp();
    window.onresize = sp;
    $(document).on('click','.gm-kc ul li',function(){
        $(this).css('background-color','#E7F5FC');
        $(this).siblings().css('background-color','#fff');
        $(this).find('i').css({'background':'url(images/221.png)no-repeat center','background-size':'100% 100%'})
        $(this).siblings().find('i').css({'background':'url(images/ico8.png)no-repeat center','background-size':'100% 100%'})
    });
    function kczx() {
        var idx = layer.open({
            title: '课程中心',
            type: 2,
            area: ['900px', '550px'],
            content: 'kczx.html' //这里content是一个URL，如果你不想让iframe出现滚动条，你还可以content: ['http://sentsin.com', 'no']
        });
    }
</script>
<script>
    layui.use(['form', 'layedit', 'laydate', 'laypage', 'layer'], function () {
        var form = layui.form
            , layer = layui.layer
            , layedit = layui.layedit
            , laydate = layui.laydate
            , laypage = layui.laypage;
    });
    function detail() {
        var idx = layer.open({
            title: '每日学习 <span style="float:right;display: block;width:auto;height:43px;line-height: 43px;">2019年7月15日</span>',
            type: 2,
            area: ['940px', '450px'],
            content: 'mrxx.html' //这里content是一个URL，如果你不想让iframe出现滚动条，你还可以content: ['http://sentsin.com', 'no']
        });
    }

    //    function detail1() {
    //        var idx = layer.open({
    //            title: '熟词集',
    //            type: 2,
    //            area: ['900px', '650px'],
    //            content: 'jyhg.html' //这里content是一个URL，如果你不想让iframe出现滚动条，你还可以content: ['http://sentsin.com', 'no']
    //        });
    //    }

    $('.btn11').on('click',function(){
        $(this).addClass('btn11-active').siblings().removeClass('btn11-active')

    });
    $('.btn12').on('click',function(){

        if($(this).hasClass('btn11-active')){
            $(this).removeClass('btn11-active')
        }else{
            $(this).addClass('btn11-active')
        }
    })

</script>
<script type="text/javascript">
    getStudyWordsCount();
    function getStudyWordsCount() {
        $.ajax({
            type:'post',
            url: getContextPath() +"/enguserOption/enguserOption/getLastWeekStudyWords",
            cache:false,
            async:false,
            data:{},
            success:function (data) {
                if (data.code==0){
                    //请求成功
                    var dom = document.getElementById("container");
                    var myChart = echarts.init(dom);
                    var app = {};
                    option = null;
                    app.title = '柱状图分数划分';
                    //获取单词数量

                    var namedate = data.updateTimes;
                    var numdate =data.wordsCount;
                    var colorlist = [];
                    numdate.forEach(element => {
                        if (element < 60) {
                        colorlist.push(["#fc7095", "#fa8466"])
                    } else if (element >= 60 && element < 90) {
                        colorlist.push(["#386ffd", "#74b3ff"])
                    } else {
                        colorlist.push(["#1aa8ce", "#49d3c6"])
                    }
                });
                    option = {

                        tooltip: {
                            trigger: 'axis',
                            axisPointer: {            // 坐标轴指示器，坐标轴触发有效
                                type: 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
                            }
                        },
                        grid: {
                            left: '3%',
                            right: '4%',
                            bottom: '3%',
                            containLabel: true
                        },
                        xAxis: [
                            {
                                type: 'category',
                                data: namedate,
                                axisTick: {
                                    alignWithLabel: true
                                },
                                axisLine: {
                                    lineStyle: {
                                        color: "#4dd1c4",
                                        width: 1
                                    }
                                },
                                axisLabel: {
                                    show: true,
                                    textStyle: {
                                        color: '#999'
                                    }
                                }
                            }
                        ],
                        yAxis: [
                            {
                                type: 'value',
                                axisLabel: {
                                    formatter: '{value} 个',
                                    show: true,
                                    textStyle: {
                                        color: '#999'
                                    }
                                },
                                axisLine: {
                                    lineStyle: {
                                        color: "#4dd1c4",
                                        width: 1
                                    }
                                },
                                splitLine: {
                                    show: true,
                                    lineStyle: {
                                        type: 'dashed',
                                        color: '#ddd'
                                    }
                                }

                            }
                        ],
                        series: [
                            {
                                name: '学习数量（个）',
                                type: 'bar',
                                barWidth: '60%',
                                data: numdate,
                                itemStyle: {
                                    normal: {
                                        // color: new echarts.graphic.LinearGradient(
                                        //     0, 0, 0, 1,
                                        //     [
                                        //         {offset: 1, color: 'red'},
                                        //         {offset: 0, color: 'orange'}
                                        //     ]
                                        // )
                                        color: function (params) {
                                            // var colorList = colorlist;
                                            // return colorList[params.dataIndex];
                                            var colorList = colorlist

                                            var index = params.dataIndex;
                                            // if(params.dataIndex >= colorList.length){
                                            //         index=params.dataIndex-colorList.length;
                                            // }
                                            return new echarts.graphic.LinearGradient(0, 0, 0, 1,
                                                [
                                                    { offset: 1, color: colorList[index][0] },
                                                    { offset: 0, color: colorList[index][1] }
                                                ]);


                                        }
                                    }
                                }
                            }
                        ]
                    };
                    ;
                    if (option && typeof option === "object") {
                        myChart.setOption(option, true);
                    }
                } else{
                    alert(data.msg);
                }
            },
            error:function () {
                alert("单词数量获取失败");
            }
        });
    }

</script>

<script type="text/javascript">
    //获取用户的学习时间方法
    getStudyTime();

    function getStudyTime() {
        $.ajax({
            type:'post',
            url: getContextPath() +"/enguserOption/enguserOption/getLastWeekStudyTime",
            cache:false,
            async:false,
            data:{},
            success:function (data) {
                if (data.code==0){

                    var dom = document.getElementById("container1");
                    var myChart = echarts.init(dom);
                    var app = {};
                    option = null;
                    app.title = '柱状图分数划分';
                    var namedate = data.loginTimeArr;
                    var numdate = data.studyTimeArr;
                    var colorlist = [];
                    numdate.forEach(element => {
                        if (element < 60) {
                        colorlist.push(["#fc7095", "#fa8466"])
                    } else if (element >= 60 && element < 90) {
                        colorlist.push(["#386ffd", "#74b3ff"])
                    } else {
                        colorlist.push(["#1aa8ce", "#49d3c6"])
                    }
                });
                    option = {

                        tooltip: {
                            trigger: 'axis',
                            axisPointer: {            // 坐标轴指示器，坐标轴触发有效
                                type: 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
                            }
                        },
                        grid: {
                            left: '3%',
                            right: '4%',
                            bottom: '3%',
                            containLabel: true
                        },
                        xAxis: [
                            {
                                type: 'category',
                                data: namedate,
                                axisTick: {
                                    alignWithLabel: true
                                },
                                axisLine: {
                                    lineStyle: {
                                        color: "#4dd1c4",
                                        width: 1
                                    }
                                },
                                axisLabel: {
                                    show: true,
                                    textStyle: {
                                        color: '#999'
                                    }
                                }
                            }
                        ],
                        yAxis: [
                            {
                                type: 'value',
                                axisLabel: {
                                    formatter: '{value} 分钟',
                                    show: true,
                                    textStyle: {
                                        color: '#999'
                                    }
                                },
                                axisLine: {
                                    lineStyle: {
                                        color: "#4dd1c4",
                                        width: 1
                                    }
                                },
                                splitLine: {
                                    show: true,
                                    lineStyle: {
                                        type: 'dashed',
                                        color: '#ddd'
                                    }
                                }

                            }
                        ],
                        series: [
                            {
                                name: '学习时间（分钟）',
                                type: 'bar',
                                barWidth: '60%',
                                data: numdate,
                                itemStyle: {
                                    normal: {
                                        // color: new echarts.graphic.LinearGradient(
                                        //     0, 0, 0, 1,
                                        //     [
                                        //         {offset: 1, color: 'red'},
                                        //         {offset: 0, color: 'orange'}
                                        //     ]
                                        // )
                                        color: function (params) {
                                            // var colorList = colorlist;
                                            // return colorList[params.dataIndex];
                                            var colorList = colorlist

                                            var index = params.dataIndex;
                                            // if(params.dataIndex >= colorList.length){
                                            //         index=params.dataIndex-colorList.length;
                                            // }
                                            return new echarts.graphic.LinearGradient(0, 0, 0, 1,
                                                [
                                                    { offset: 1, color: colorList[index][0] },
                                                    { offset: 0, color: colorList[index][1] }
                                                ]);


                                        }
                                    }
                                }
                            }
                        ]
                    };
                    ;
                    if (option && typeof option === "object") {
                        myChart.setOption(option, true);
                    }

                }else{
                    alert(data.msg);
                }
            },
            error:function () {
                alert("时间获取失败");
            }
        });
    }
    $(document).on('click','.layui-tab-title  li:first-child',function(){
        $(".layui-tab-title  li:first-child img").attr("src", "images/10.png");
        $(".layui-tab-title  li:nth-child(2) img").attr("src", "images/11-1.png");
        $(".layui-tab-title  li:nth-child(3) img").attr("src", "images/12-1.png");
    });
    $(document).on('click','.layui-tab-title  li:nth-child(2)',function(){
        $(".layui-tab-title  li:first-child img").attr("src", "images/10-1.png");
        $(".layui-tab-title  li:nth-child(2) img").attr("src", "images/11.png");
        $(".layui-tab-title  li:nth-child(3) img").attr("src", "images/12-1.png");
    });
    $(document).on('click','.layui-tab-title  li:last-child',function(){
        $(".layui-tab-title  li:first-child img").attr("src", "images/10-1.png");
        $(".layui-tab-title  li:nth-child(2) img").attr("src", "images/11-1.png");
        $(".layui-tab-title  li:nth-child(3) img").attr("src", "images/12.png");
    });
</script>

<script>

    //获取该用户课程详情
    getCourseInfo();
    function getCourseInfo() {
        var tbodyHtml="";
        $.ajax({
            type:'post',
            url: getContextPath() +"/enguserOption/enguserOption/getCourseInfo",
            cache:false,
            async:false,
            data:{},
            success:function (data) {
                console.log('data',data);
                var courseInfoS=data;
                for (var i=0;i<courseInfoS.length;i++){
                    var courseInfo=courseInfoS[i];
                    var count=courseInfo.score;
                    if (count==null||count==undefined){
                        count=0;
                    }
                tbodyHtml+="<tr><td>"+courseInfo.courseName+"</td><td>本书已学单词:" + courseInfo.completionWords +
                    "；未学单词:" +courseInfo.waitLearningWords+
                    "；现有生词:" +courseInfo.hardWords+
                    "；熟词:" +courseInfo.skilledWords+
                    "；备忘单词:" +courseInfo.strengthenMemoryWords+
                    "</td><td>"+count+"</td></tr>";
                }
                $("#tbody").append(tbodyHtml);
            }
        });
    }
    alreadyPurchase();
    function alreadyBuyCourses(courseId) {
        // window.location.href = getContextPath() + '/webclient/dcxl.html?courseId=' + courseId;
        var currenturl = window.location.href;
        console.log(currenturl);
        var newUrl = (currenturl.split("?"))[0];
        history.pushState('', '', newUrl + '?courseId=' + courseId);//前两个参数可省略
    }
</script>
<script src="js/bgmusic.js"></script>
</html>